"use strict";

document.addEventListener('DOMContentLoaded', function () {
  // inputmask
  Inputmask().mask(document.querySelectorAll('input'));

  // mobile menu
  var header = document.getElementById('header');
  var mobileMenu = document.getElementById('menu');
  var mobileMenuTrigger = document.getElementById('hamburger-toggle');
  if (mobileMenu && mobileMenuTrigger) {
    mobileMenuTrigger.addEventListener('click', function (event) {
      event.preventDefault();
      if (mobileMenu.classList.contains('is--active')) {
        header.classList.remove('is--menu');
        mobileMenuTrigger.classList.remove('is--active');
        mobileMenu.classList.remove('is--active');
        document.body.classList.remove('scroll-disabled');
      } else {
        header.classList.add('is--menu');
        mobileMenuTrigger.classList.add('is--active');
        mobileMenu.classList.add('is--active');
        document.body.classList.add('scroll-disabled');
      }
    });
  }

  // iframe loading
  var contentVideoIframe = document.querySelectorAll('.content-video__media');
  if (contentVideoIframe) {
    contentVideoIframe.forEach(function (item) {
      item.addEventListener('click', function (event) {
        event.preventDefault();
        var parent = item.closest('.content-video');
        if (!parent.classList.contains('is--active')) {
          parent.classList.add('is--active');
          var frame = parent.querySelector('iframe');
          var link = frame.dataset.src.indexOf('?') > -1 ? frame.dataset.src + '&autoplay=1' : frame.dataset.src + '?autoplay=1';
          frame.setAttribute('src', link);
          frame.removeAttribute('data-src');
        }
      });
    });
  }

  // reviews slider
  var reviewsSlider = document.querySelector('.reviews__slider .swiper');
  if (reviewsSlider) {
    var myReviewsSlider = new Swiper(reviewsSlider, {
      slidesPerView: 'auto',
      spaceBetween: 56,
      loop: true,
      pagination: {
        el: '.reviews__slider .swiper-pagination',
        type: 'bullets',
        clickable: true
      },
      navigation: {
        prevEl: '.reviews__slider .swiper-button-prev',
        nextEl: '.reviews__slider .swiper-button-next'
      },
      breakpoints: {
        0: {
          spaceBetween: 12
        },
        1400: {
          spaceBetween: 56
        }
      }
    });
  }

  // big reviews slider
  var bigReviewsSoloSlider = document.querySelector('.big-reviews__slider .swiper');
  if (bigReviewsSoloSlider) {
    var myBigReviewsSoloSlider = new Swiper(bigReviewsSoloSlider, {
      slidesPerView: 1,
      spaceBetween: 60,
      loop: true,
      pagination: {
        el: '.big-reviews__slider .swiper-pagination',
        type: 'bullets',
        clickable: true
      },
      navigation: {
        prevEl: '.big-reviews__slider .swiper-button-prev',
        nextEl: '.big-reviews__slider .swiper-button-next'
      },
      breakpoints: {
        0: {
          spaceBetween: 10
        },
        375: {
          spaceBetween: 30
        },
        1024: {
          spaceBetween: 20
        },
        1400: {
          spaceBetween: 60
        }
      }
    });
  }

  // big reviews thumbnail slider
  var bigReviewsMainSlider = document.querySelector('.big-reviews__main-slider .swiper');
  var bigReviewsThumbnailSlider = document.querySelector('.big-reviews__thumbnail .swiper');
  if (bigReviewsMainSlider && bigReviewsThumbnailSlider) {
    var myBigReviewsThumbnailSlider = new Swiper(bigReviewsThumbnailSlider, {
      spaceBetween: 30,
      slidesPerView: 'auto',
      watchSlidesVisibility: true,
      watchSlidesProgress: true,
      breakpoints: {
        0: {
          allowTouchMove: true
        },
        768: {
          allowTouchMove: false
        }
      }
    });
    var myBigReviewsMainSlider = new Swiper(bigReviewsMainSlider, {
      slidesPerView: 1,
      spaceBetween: 60,
      pagination: {
        el: '.big-reviews__main-slider .swiper-pagination',
        type: 'bullets',
        clickable: true
      },
      navigation: {
        prevEl: '.big-reviews__main-slider .swiper-button-prev',
        nextEl: '.big-reviews__main-slider .swiper-button-next'
      },
      breakpoints: {
        0: {
          spaceBetween: 10
        },
        375: {
          spaceBetween: 30
        },
        1024: {
          spaceBetween: 20
        },
        1400: {
          spaceBetween: 60
        }
      },
      thumbs: {
        swiper: myBigReviewsThumbnailSlider
      }
    });
    bigReviewsThumbnailSlider.querySelectorAll('.swiper-slide').forEach(function (item) {
      item.addEventListener('click', function () {
        bigReviewsThumbnailSlider.querySelectorAll('.swiper-slide').forEach(function (child) {
          return child.classList.remove('is--active');
        });
        item.classList.add('is--active');
        myBigReviewsThumbnailSlider.slideTo(item.dataset.index);
      });
    });
    myBigReviewsMainSlider.on('slideChange', function () {
      myBigReviewsThumbnailSlider.slideTo(myBigReviewsMainSlider.realIndex);
      bigReviewsThumbnailSlider.querySelectorAll('.swiper-slide').forEach(function (child) {
        return child.classList.remove('is--active');
      });
      bigReviewsThumbnailSlider.querySelectorAll('.swiper-slide')[myBigReviewsMainSlider.realIndex].classList.add('is--active');
    });
  }

  // portfolio slider
  var portfolioSlider = document.querySelector('.portfolio__slider .swiper');
  if (portfolioSlider && window.innerWidth <= 767) {
    var myPortfolioSlider = new Swiper(portfolioSlider, {
      slidesPerView: 'auto',
      spaceBetween: 20,
      loop: true,
      navigation: {
        prevEl: '.portfolio__slider .swiper-button-prev',
        nextEl: '.portfolio__slider .swiper-button-next'
      }
    });
  }

  // special offers slider
  var specialOffersSlider = document.querySelector('.special-offers__slider .swiper');
  if (specialOffersSlider && window.innerWidth <= 767) {
    var mySpecialOffersSlider = new Swiper(specialOffersSlider, {
      slidesPerView: 'auto',
      spaceBetween: 10,
      loop: true,
      navigation: {
        prevEl: '.special-offers__slider .swiper-button-prev',
        nextEl: '.special-offers__slider .swiper-button-next'
      }
    });
  }

  // main catalog slider
  var mainCatalogSlider = document.querySelector('.main-catalog__slider .swiper');
  if (mainCatalogSlider && window.innerWidth <= 767) {
    var myMainCatalogSlider = new Swiper(mainCatalogSlider, {
      slidesPerView: 'auto',
      spaceBetween: 20,
      loop: true,
      navigation: {
        prevEl: '.main-catalog__slider .swiper-button-prev',
        nextEl: '.main-catalog__slider .swiper-button-next'
      }
    });
  }

  // install sewerage slider
  var installSewerageSlider = document.querySelector('.install-sewerage__slider .swiper');
  if (installSewerageSlider && window.innerWidth <= 767) {
    var myInstallSewerageSlider = new Swiper(installSewerageSlider, {
      slidesPerView: 'auto',
      spaceBetween: 20,
      loop: true,
      navigation: {
        prevEl: '.install-sewerage__slider .swiper-button-prev',
        nextEl: '.install-sewerage__slider .swiper-button-next'
      }
    });
  }

  // services slider
  var servicesSlider = document.querySelector('.services__slider .swiper');
  if (servicesSlider && window.innerWidth <= 767) {
    var myServicesSlider = new Swiper(servicesSlider, {
      slidesPerView: 'auto',
      spaceBetween: 20,
      loop: true,
      navigation: {
        prevEl: '.services__slider .swiper-button-prev',
        nextEl: '.services__slider .swiper-button-next'
      }
    });
  }

  // articles slider
  var articlesSlider = document.querySelector('.articles__slider .swiper');
  if (articlesSlider && window.innerWidth <= 767) {
    var myArticlesSlider = new Swiper(articlesSlider, {
      slidesPerView: 'auto',
      spaceBetween: 20,
      loop: true,
      navigation: {
        prevEl: '.articles__slider .swiper-button-prev',
        nextEl: '.articles__slider .swiper-button-next'
      }
    });
  }
});